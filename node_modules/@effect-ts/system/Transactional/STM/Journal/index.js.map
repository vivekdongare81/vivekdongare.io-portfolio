{"version":3,"file":"index.js","mappings":"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","names":["prepareResetJournal","journal","saved","Map","entry","set","use","_","copy","clear","commitJournal","commit","analyzeJournal","val","isInvalid","isChanged","emptyTodoMap","HM","make","collectTodos","allTodos","tref","todos","todo","get","execTodos","completeTodos","io","size","Done","addTodo","txnId","todoEffect","added","oldTodo","has_","newTodo","set_","untrackedTodoTargets","oldJournal","newJournal","untracked","key","value","has","isNew","tryCommit","fiberId","stm","r","STMDriver","run","analysis","Error","_typeId","RetryTypeId","Suspend","SucceedTypeId","T","succeed","FailTypeId","fail","DieTypeId","die","completeTryCommit","k","done","suspendTryCommit","accum","tryCommitAsync","undefined","v","DoneTypeId","SuspendTypeId","isValid","valid"],"sourceRoot":"","sources":["../../../_src/Transactional/STM/Journal/index.ts"],"sourcesContent":[null]}